<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Missing Signage Report</title>
    <style>
      body {
        background: #1d1d1f;
        color: #f5f5f7;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        font-family: -apple-system, BlinkMacSystemFont, "SF Mono", monospace;
      }
      .container {
        width: 90%;
        max-width: 1000px; /* Increased container width */
        /* margin: 20px auto; */
        text-align: center;
      }
      h1 {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 20px;
      }
      .alert {
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 20px;
        font-size: 18px;
        font-weight: 500;
      }
      .alert-danger {
        background: #ff3b30;
        color: #fff;
      }
      .alert-success {
        background: #32d74b;
        color: #fff;
      }
      .missing-signs {
        background: #2c2c2e;
        /* padding: 15px; */
        border-radius: 12px;
        height: 0%;
        /* margin-bottom: 20px; */
        /* box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); */
      }
      video {
        width: 100%;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      }
      .carousel-container {
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
        width: 100%;
        max-width: 100%; /* Increased carousel width */
      }
      .carousel {
        display: flex;
        width: 100%;
        transition: transform 0.5s ease-in-out;
      }
      .carousel-item {
        flex-shrink: 0;
        width: 100%;
        box-sizing: border-box;
      }
      .carousel img {
        width: 100%;
        max-width: 1000px; /* Expanded image width */
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      }
      .carousel-indicators {
        display: flex;
        justify-content: center;
        margin-top: 10px;
        gap: 10px;
      }
      .carousel-indicator {
        width: 40px;
        height: 10px;
        background: #bbbbbb;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease-in-out;
      }
      .carousel-indicator.active {
        background: grey;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Missing Signage Report</h1>
      <div class="video-container">
        <video controls>
          <source
            src="{{'/'+ '/'.join(video_data.output_path.replace('\\', '/').split('/')[-4:]) }}"
            type="video/mp4"
          />
          Your browser does not support the video tag.
        </video>
      </div>

      {% if missing_signs_data['number_of_missing_signs'] > 0 %}
      <div class="alert alert-danger">
        ‚ö†Ô∏è Missing Sign Detected: {{
        missing_signs_data['number_of_missing_signs'] }}
      </div>
      <div class="carousel-container">
        <div class="carousel">
          {% for sign in missing_signs_data['missing_signs_details'] %}
          <div class="carousel-item">
            <div class="missing-signs">
              <h3>üöß {{ sign['missing_sign_type'] }}</h3>
              <p>
                <strong>Associated Lane Marking:</strong> {{
                sign['marking_type'] }}
              </p>
              <p>
                <strong>Frames Detected:</strong> {{ sign['frame_range'][0] }} -
                {{ sign['frame_range'][1] }}
              </p>
              <img src="{{ sign['frame_path'] }}" alt="Missing Sign Evidence" />
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      <div class="carousel-indicators"></div>
      {% else %}
      <div class="alert alert-success">‚úÖ No missing signage detected.</div>
      {% endif %}
    </div>

    <script>
      const carousel = document.querySelector(".carousel");
      const items = carousel.querySelectorAll(".carousel-item");
      const indicatorsContainer = document.querySelector(
        ".carousel-indicators"
      );
      let currentIndex = 0;

      function updateIndicators() {
        const indicators = document.querySelectorAll(".carousel-indicator");
        indicators.forEach((indicator, index) => {
          indicator.classList.toggle("active", index === currentIndex);
        });
      }

      function scrollCarousel(direction) {
        if (direction === "right") {
          currentIndex = (currentIndex + 1) % items.length;
        } else if (direction === "left") {
          currentIndex = (currentIndex - 1 + items.length) % items.length;
        }

        carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
        updateIndicators();
      }

      items.forEach((_, index) => {
        const indicator = document.createElement("div");
        indicator.classList.add("carousel-indicator");
        if (index === 0) indicator.classList.add("active");
        indicator.addEventListener("click", () => {
          currentIndex = index;
          carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
          updateIndicators();
        });
        indicatorsContainer.appendChild(indicator);
      });

      carousel.style.transform = "translateX(0)";
    </script>
  </body>
</html>